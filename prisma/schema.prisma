generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model Organization {
  id                       String    @default(dbgenerated("gen_random_uuid()"))
  name                     String
  ownerId                  String?   @map("owner_id")
  planType                 String?   @default("basic") @map("plan_type")
  createdAt                DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  whatsappConnectionsLimit Int?      @default(1) @map("whatsapp_connections_limit")

  @@map("organizations")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model User {
  id                  String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email               String
  name                String?
  createdAt           DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  organizationId      String?   @map("organization_id")
  onboardingCompleted Boolean   @default(false) @map("onboarding_completed")
  koinsBalance        Int       @default(0) @map("koins_balance")
  role                String    @default("user")
  companyPhone        String?   @map("company_phone")
  password            String?
  personalPhone       String?   @map("personal_phone")
  referredById        String?   @map("referred_by") @db.Uuid
  telegramId          String?   @map("telegram_id")

  @@map("users")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model Partner {
  id                     String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId                 String    @map("user_id") @db.Uuid
  affiliateCode          String    @map("affiliate_code") @db.VarChar(50)
  commissionPercentage   Decimal?  @default(10.0) @map("commission_percentage") @db.Decimal(5, 2)
  status                 String?   @default("active") @db.VarChar(20)
  walletBalancePending   Decimal?  @default(0.0) @map("wallet_balance_pending") @db.Decimal(12, 2)
  walletBalanceAvailable Decimal?  @default(0.0) @map("wallet_balance_available") @db.Decimal(12, 2)
  createdAt              DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("partners")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model PartnerClick {
  id        String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  partnerId String    @map("partner_id") @db.Uuid
  ipAddress String?   @map("ip_address") @db.VarChar(100)
  userAgent String?   @map("user_agent")
  timestamp DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("partner_clicks")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model PartnerCommission {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  partnerId  String    @map("partner_id") @db.Uuid
  referralId String    @map("referral_id") @db.Uuid
  amount     Decimal   @db.Decimal(12, 2)
  status     String?   @default("pending") @db.VarChar(20)
  createdAt  DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("partner_commissions")
  @@ignore
}

model BillingHistory {
  id        String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId    String    @map("user_id") @db.Uuid
  amount    Int
  value     Decimal   @db.Decimal(10, 2)
  status    String    @default("pending")
  createdAt DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("billing_history")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model WhatsAppInstance {
  id             String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId         String?   @map("user_id") @db.Uuid
  instanceName   String    @map("instance_name")
  instanceToken  String?   @map("instance_token")
  status         String?   @default("DISCONNECTED")
  createdAt      DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  last_checked   DateTime? @db.Timestamptz(6)
  organizationId String?   @map("organization_id")

  @@map("whatsapp_instances")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model Lead {
  id                String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId            String?   @map("user_id") @db.Uuid
  name              String
  company           String?
  value             Decimal?  @db.Decimal(12, 2)
  status            String?   @default("new")
  tags              String[]
  lastContact       DateTime? @default(now()) @map("last_contact") @db.Timestamptz(6)
  createdAt         DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  source            String?
  organizationId    String?   @map("organization_id")
  phone             String?   @default("")
  email             String?   @default("")
  notes             String?
  productId         String?   @map("product_id") @db.Uuid
  followupStatus    String?   @default("active")
  followupStep      Int       @default(0) @map("followup_step")
  lastInteractionAt DateTime? @map("last_interaction_at") @db.Timestamptz(6)

  @@map("leads")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_columns {
  id              String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id         String?   @db.Uuid
  title           String
  order_index     Int
  color           String?
  is_system       Boolean?  @default(false)
  created_at      DateTime? @default(now()) @db.Timestamptz(6)
  organization_id String?

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_sources {
  id              String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id         String?   @db.Uuid
  name            String
  active          Boolean?  @default(true)
  created_at      DateTime? @default(now()) @db.Timestamptz(6)
  is_system       Boolean?  @default(false)
  organization_id String?

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model IaConfig {
  id             String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId         String   @map("user_id") @db.Uuid
  organizationId String?  @map("organization_id")
  companyName    String   @map("company_name")
  mainProduct    String   @map("main_product")
  productPrice   String?  @map("product_price")
  agentObjective String   @map("agent_objective")
  initialPrompt  String?  @map("initial_prompt")
  desiredRevenue String?  @map("desired_revenue")
  trainingFiles  Json?    @default("[]") @map("training_files")
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  @@map("ia_configs")
  @@ignore
}

model Agent {
  id                 String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  organizationId     String   @map("organization_id")
  name               String
  type               String
  status             String   @default("active")
  systemPrompt       String?  @map("system_prompt")
  modelConfig        Json?    @default("{}") @map("model_config")
  createdAt          DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt          DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  trainingFiles      Json?    @default("[]") @map("training_files")
  whatsappInstanceId String?  @map("whatsapp_instance_id") @db.Uuid

  @@map("agents")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model ChatMessage {
  id               String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  agentId          String   @map("agent_id") @db.Uuid
  remoteJid        String   @map("remote_jid")
  role             String
  content          String
  createdAt        DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  promptTokens     Int?     @map("prompt_tokens")
  completionTokens Int?     @map("completion_tokens")
  tokenCost        Decimal? @map("token_cost") @db.Decimal(10, 6)

  @@map("chat_messages")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model ChatSession {
  id        String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  agentId   String   @map("agent_id") @db.Uuid
  remoteJid String   @map("remote_jid")
  isPaused  Boolean  @default(false) @map("is_paused")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("chat_sessions")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model Vendedor {
  id                  String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  organizationId      String   @map("organization_id")
  nome                String
  email               String
  whatsapp            String?
  porcentagem         Int      @default(50)
  leadsRecebidosCiclo Int      @default(0) @map("leads_recebidos_ciclo")
  ativo               Boolean  @default(true)
  createdAt           DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("vendedores")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model DisponibilidadeVendedor {
  id         String @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  vendedorId String @map("vendedor_id") @db.Uuid
  diaSemana  Int    @map("dia_semana")
  horaInicio String @map("hora_inicio")
  horaFim    String @map("hora_fim")
  intervalo  Int    @default(30)

  @@map("disponibilidade_vendedor")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model BloqueioAgenda {
  id         String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  vendedorId String   @map("vendedor_id") @db.Uuid
  dataInicio DateTime @map("data_inicio") @db.Timestamptz(6)
  dataFim    DateTime @map("data_fim") @db.Timestamptz(6)
  motivo     String?

  @@map("bloqueios_agenda")
  @@ignore
}

model Agendamento {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  vendedorId String   @map("vendedor_id") @db.Uuid
  leadId     String?  @map("lead_id") @db.Uuid
  dataHora   DateTime @map("data_hora") @db.Timestamptz(6)
  duracao    Int      @default(30)
  status     String   @default("agendado")
  notas      String?
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("agendamentos")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model Notification {
  id        String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId    String    @map("user_id") @db.Uuid
  title     String
  message   String
  read      Boolean?  @default(false)
  createdAt DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("notifications")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model Product {
  id               String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name             String
  description      String?
  price            Decimal  @db.Decimal(10, 2)
  active           Boolean  @default(true)
  createdAt        DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt        DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  organizationId   String?  @map("organization_id")
  koinsBonus       Int      @default(0) @map("koins_bonus")
  connectionsBonus Int?     @default(0) @map("connections_bonus")
  type             String?  @default("KOINS") @db.VarChar(50)

  @@map("products")
  @@ignore
}

model ApiKey {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId     String    @map("user_id") @db.Uuid
  keyPrefix  String    @map("key_prefix")
  hashedKey  String    @map("hashed_key")
  name       String
  lastUsedAt DateTime? @map("last_used_at") @db.Timestamptz(6)
  createdAt  DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("api_keys")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model WebhookSubscription {
  id        String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId    String   @map("user_id") @db.Uuid
  targetUrl String   @map("target_url")
  events    String[]
  secret    String
  active    Boolean  @default(true)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("webhook_subscriptions")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model FollowupSequence {
  id        String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId    String   @map("user_id") @db.Uuid
  delayDays Int      @map("delay_days")
  message   String
  imageUrl  String?  @map("image_url")
  active    Boolean  @default(true)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("followup_sequences")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model message_buffer {
  id            BigInt    @default(autoincrement())
  remote_jid    String
  agent_id      String    @db.Uuid
  instance_name String
  content       String?
  image_url     String?
  is_audio      Boolean?  @default(false)
  received_at   DateTime? @default(now()) @db.Timestamptz(6)
  processed     Boolean?  @default(false)

  @@ignore
}
